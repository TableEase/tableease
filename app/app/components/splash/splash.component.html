<app-home></app-home>
<div *ngIf="allDataFetched">

  <form class="form" #frm="ngForm" (ngSubmit)="onSearch()" style="width: 50%;float: left">

    <div>
      <label>Allergies</label>
      <div class="col-xs-4" *ngFor="let allergy of allergies;let i = index;">
        <div class="checkbox-inline center">
          <input name="{{allergy.name}}" type="checkbox"
                 [checked]="allergy?.checked" (change)="onCheckboxChange(allergy?.checked, i)">
          <label [for]="allergy.name">{{allergy.name}}</label>
        </div>
      </div>
    </div>


    <div>
      <label>Price Range: {{rangeValues[0] + ' - ' + rangeValues[1]}}</label>
      <p-slider name="price" [ngModel]="rangeValues" [style]="{'width':'200px'}" range="true"></p-slider>
    </div>


    <button type="submit" class="btn btn-primary" [disabled]="!frm.valid">Search</button>
  </form>
  <app-map></app-map>
  <hr>
  <h1>Results</h1>
  <clr-stack-view>
    <clr-stack-header class="cap">
    </clr-stack-header>
    <div *ngFor="let meal of meals">


      <clr-stack-block>

        <clr-stack-label>{{meal.name}}</clr-stack-label>
        <div class="flexMe">
          <clr-stack-content>{{meal.description}}</clr-stack-content>
          <clr-stack-content>
          </clr-stack-content>
        </div>

        <clr-stack-block>
          <clr-stack-label>Allergies</clr-stack-label>
          <clr-stack-content *ngIf="meal.allergies.length > 0">
            <span *ngFor="let allergy of meal.allergies;let last=last;let i = index">{{allergy.name}}{{last ? '' : (i==meal.allergies.length-2) ? ' and ' : ', '}}</span>
          </clr-stack-content>
        </clr-stack-block>

        <clr-stack-block>
          <clr-stack-label>Price</clr-stack-label>
          <clr-stack-content>${{meal.price}}</clr-stack-content>
        </clr-stack-block>

      </clr-stack-block>

    </div>

  </clr-stack-view>
</div>
